var ThingHittr;
(function(ThingHittr_1){var ThingHittr=function(){function ThingHittr(settings){if(typeof settings==="undefined")throw new Error("No settings object given to ThingHittr.");if(typeof settings.globalCheckGenerators==="undefined")throw new Error("No globalCheckGenerators given to ThingHittr.");if(typeof settings.hitCheckGenerators==="undefined")throw new Error("No hitCheckGenerators given to ThingHittr.");if(typeof settings.hitCallbackGenerators==="undefined")throw new Error("No hitCallbackGenerators given to ThingHittr.");this.keyNumQuads=
settings.keyNumQuads||"numquads";this.keyQuadrants=settings.keyQuadrants||"quadrants";this.keyGroupName=settings.keyGroupName||"group";this.keyTypeName=settings.keyTypeName||"type";this.globalCheckGenerators=settings.globalCheckGenerators;this.hitCheckGenerators=settings.hitCheckGenerators;this.hitCallbackGenerators=settings.hitCallbackGenerators;this.generatedHitChecks={};this.generatedHitCallbacks={};this.generatedGlobalChecks={};this.generatedHitsChecks={};this.groupHitLists=this.generateGroupHitLists(this.hitCheckGenerators)}
ThingHittr.prototype.cacheChecksForType=function(typeName,groupName){if(!this.generatedGlobalChecks.hasOwnProperty(typeName)&&this.globalCheckGenerators.hasOwnProperty(groupName)){this.generatedGlobalChecks[typeName]=this.globalCheckGenerators[groupName]();this.generatedHitsChecks[typeName]=this.generateHitsCheck(typeName)}};ThingHittr.prototype.checkHitsForThing=function(thing){this.generatedHitsChecks[thing[this.keyTypeName]](thing)};ThingHittr.prototype.checkHitForThings=function(thing,other){return this.runThingsFunctionSafely(this.generatedHitChecks,
thing,other,this.hitCheckGenerators)};ThingHittr.prototype.runHitCallbackForThings=function(thing,other){this.runThingsFunctionSafely(this.generatedHitCallbacks,thing,other,this.hitCallbackGenerators)};ThingHittr.prototype.generateHitsCheck=function(typeName){var _this=this;return function(thing){if(!_this.generatedGlobalChecks[typeName](thing))return;var groupNames=_this.groupHitLists[thing[_this.keyGroupName]],groupName,others,other,i,j,k;for(i=0;i<thing[_this.keyNumQuads];i+=1)for(j=0;j<groupNames.length;j+=
1){groupName=groupNames[j];others=thing[_this.keyQuadrants][i].things[groupName];for(k=0;k<others.length;k+=1){other=others[k];if(thing===other)break;if(!_this.generatedGlobalChecks[other[_this.keyTypeName]](other))continue;if(_this.checkHitForThings(thing,other))_this.runHitCallbackForThings(thing,other)}}}};ThingHittr.prototype.runThingsFunctionSafely=function(group,thing,other,generators){var typeThing=thing[this.keyTypeName],typeOther=other[this.keyTypeName],container=group[typeThing],check;if(!container)container=
group[typeThing]={};check=container[typeOther];if(!check)check=container[typeOther]=generators[thing[this.keyGroupName]][other[this.keyGroupName]]();return check(thing,other)};ThingHittr.prototype.generateGroupHitLists=function(group){var output={},i;for(i in group)if(group.hasOwnProperty(i))output[i]=Object.keys(group[i]);return output};return ThingHittr}();ThingHittr_1.ThingHittr=ThingHittr})(ThingHittr||(ThingHittr={}));